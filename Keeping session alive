import org.apache.spark.sql.{SparkSession, DataFrame}

object MySparkApp {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession.builder
      .appName("My Spark Application")
      .getOrCreate()

    try {
      // Creating a sample DataFrame
      val df: DataFrame = spark.createDataFrame(Seq(
        ("Alice", 29),
        ("Bob", 34)
      )).toDF("name", "age")

      // Your Spark job logic here
      // ...

      // Condition1: Check if DataFrame is empty
      val condition1 = df.isEmpty

      if (condition1) {
        println("DataFrame is empty. Exiting with code 1.")
        System.exit(1)
      } else {
        println("DataFrame is not empty. Exiting with code 0 (success).")
        System.exit(0)
      }

    } catch {
      case e: Exception =>
        println(s"An error occurred: ${e.getMessage}")
        // If an exception occurs, exit with a custom error code, e.g., 99
        System.exit(99)
    }
  }
}
