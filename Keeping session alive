import org.apache.spark.sql.SparkSession

object Main {
  def main(args: Array[String]): Unit = {

    // Initialize SparkSession
    val spark = SparkSession.builder.appName("Spark Scala SOH Replacement").getOrCreate()

    // Load the text file as a single string
    val textFile = spark.sparkContext.wholeTextFiles("path_to_your_file").values

    // Define the string to find and its replacement
    val toFind = "SOH\n         "
    val replacement = "SOH\"\n        \""

    // Replace the string
    val replacedTextFile = textFile.map(content => content.replaceAll(toFind, replacement))

    // Save the result to a new text file
    replacedTextFile.saveAsTextFile("path_to_output_file")
    
    spark.stop()
  }
}
