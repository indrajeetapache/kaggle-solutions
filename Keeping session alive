import org.apache.spark.sql.SparkSession

object MySparkApp {
  def main(args: Array[String]): Unit = {
    val spark = SparkSession.builder
      .appName("My Spark Application")
      .getOrCreate()

    try {
      // Your Spark job logic here
      // ...

      // Check some conditions to decide the exit code
      val condition1 = //... evaluate your first condition
      val condition2 = //... evaluate your second condition

      if (condition1) {
        println("Exiting with code 1 due to condition 1")
        System.exit(1)
      } else if (condition2) {
        println("Exiting with code 2 due to condition 2")
        System.exit(2)
      } else {
        println("Exiting with code 0 (success)")
        System.exit(0)
      }
      
    } catch {
      case e: Exception =>
        println(s"An error occurred: ${e.getMessage}")
        // If an exception occurs, exit with a custom error code, e.g., 99
        System.exit(99)
    }
  }
}
