# common/log.py

class SparkLogger:
    """
    A reusable logging utility for Spark applications.
    Provides access to Spark's Log4j logger.
    """

    def __init__(self, spark_session, log_name="MyLogger"):
        """
        Initialize the logger with Spark's Log4j.

        Args:
            spark_session: Active Spark session.
            log_name (str): Name of the logger.
        """
        log4j_logger = spark_session._jvm.org.apache.log4j
        self.logger = log4j_logger.LogManager.getLogger(log_name)

    def info(self, message):
        """Log an INFO message."""
        self.logger.info(message)

    def warn(self, message):
        """Log a WARN message."""
        self.logger.warn(message)

    def error(self, message):
        """Log an ERROR message."""
        self.logger.error(message)

    def debug(self, message):
        """Log a DEBUG message."""
        self.logger.debug(message)

    def critical(self, message):
        """Log a CRITICAL message."""
        self.logger.fatal(message)

