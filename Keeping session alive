spark3-submit \
  --master yarn \
  --deploy-mode cluster \
  --name TRIALS_DETAIL_DLY \
  --conf spark.yarn.maxAppAttempts=1 \
  --conf "spark.executor.extraJavaOptions=-Duser.timezone=UTC" \
  --conf "spark.driver.extraJavaOptions=-Duser.timezone=UTC" \
  --conf "spark.sql.session.timeZone=UTC" \
  --conf "spark.yarn.appMasterEnv.TZ=UTC" \
  --conf "spark.executorEnv.TZ=UTC" \
  --conf "spark.driver.extraJavaOptions=-Dlog4j.configurationFile=log4j2.properties" \
  --conf "spark.executor.extraJavaOptions=-Dlog4j.configurationFile=log4j2.properties" \
  --conf "spark.yarn.appMasterEnv.logUID=460e4ee9-9773-4f6b-a77a-0789f82b607c" \
  --files log4j2.properties \
  your_script.py  # Replace with your actual script

conf.set("dfs.checksum.combine.mode", "COMPOSITE_CRC")
  conf.set("fs.gs.checksum.type", "CRC32C")
--conf spark.yarn.principal=user@REALM.COM \
  --conf spark.yarn.keytab=/path/to/user.keytab \


from pyspark.sql import SparkSession
import getpass

spark = SparkSession.builder.appName("KerberosTest").getOrCreate()

print("✅ Spark session started")
print(f"✅ User running the job: {getpass.getuser()}")

df = spark.range(5)
df.show()

spark.stop()
