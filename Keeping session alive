import re

# Create a regular expression to find "ibd" in the id field
regex = re.compile("ibd", re.IGNORECASE)  # re.IGNORECASE to make the search case-insensitive

# Additional filter criteria
additional_filter = {
    "reconciliation_success": True,
    "timestamp": {"$gte": start_date, "$lte": end_date}
}

# Merge the regular expression filter and additional filter criteria
query_filter = {"id": regex, **additional_filter}

# Perform the query using the regular expression and additional filter criteria
documents = collection.find(query_filter)

# Print each matching document
for doc in documents:
    print(doc)
====

import json

# Path to your JSON file
file_path = 'your_data.json'

data = []
with open(file_path, 'r') as file:
    for line in file:
        data.append(json.loads(line))  # Load each line as a separate JSON object

print(data)


=====

# Convert all values in search_criteria to lowercase
search_criteria_lower = [{k: v.lower() for k, v in criteria.items()} for criteria in search_criteria]

# Filter the list of dictionaries based on the presence of any of the search criteria
filtered_data = [d for d in data if any(all(d.get(key, '').lower() == value for key, value in criteria.items()) for criteria in search_criteria_lower)]
===============

import pandas as pd
import json

# Path to your JSON file
file_path = 'your_data.json'

# Load the JSON data into a Python list of dictionaries
with open(file_path, 'r') as file:
    data = json.load(file)  # This loads the whole JSON array into a list of dictionaries

# Define the dictionary containing keys and values to search for
search_dict = {
    'key1': 'value1',
    'key2': 'value2',
    # Add more key-value pairs as needed
}

# Convert values in the search dictionary to lowercase for case-insensitive comparison
search_dict_lower = {k: v.lower() for k, v in search_dict.items()}

# Filter the list of dictionaries based on the values in the nested dictionary
filtered_data = [d for d in data if isinstance(d.get('other_keys'), dict) and all(d.get('other_keys').get(key, '').lower() == value for key, value in search_dict_lower.items())]

# Filter the remaining dictionaries based on the keys and values in the main dictionary
filtered_data = [d for d in filtered_data if all(d.get(key, '').lower() == value for key, value in search_dict_lower.items())]

# Create a DataFrame from the filtered list of dictionaries
df = pd.DataFrame(filtered_data)

# Display the DataFrame
print(df)
====

jobdetails_Collection_Filtered_dict = [d for d in jobdetails_Collection_Filtered_dict if isinstance(d.get('other_keys'), dict) and all(d.get('other_keys').get(key, "").lower() == value for key, value in collection_child_Search_criteria)]
