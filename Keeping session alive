val updatedDF = df.columns.foldLeft(df) { (tempDF, columnName) =>
  tempDF.withColumn(columnName, expr(s"substring_index($columnName, '$separator', 1)"))
}
