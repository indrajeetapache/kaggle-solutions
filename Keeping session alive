import java.time.format.{DateTimeFormatter, DateTimeParseException}
import java.time.{LocalDate, Year, YearMonth}

def isValidDate(value: String, format: String): Boolean = {
  try {
    format match {
      case "yyyy" =>
        Year.parse(value, DateTimeFormatter.ofPattern(format))
      case "yyyyMM" | "MMyyyy" =>
        YearMonth.parse(value, DateTimeFormatter.ofPattern(format))
      case _ =>
        LocalDate.parse(value, DateTimeFormatter.ofPattern(format))
    }
    true // If parsing is successful, return true
  } catch {
    case _: DateTimeParseException => false // If parsing fails, return false
  }
}
