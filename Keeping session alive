import org.apache.spark.sql.functions._
import org.apache.spark.sql.SparkSession

val spark = SparkSession.builder.appName("example").master("local[1]").getOrCreate()

val data = Seq(
  (1, "foo", 3.0),
  (2, "bar", 4.0),
  (3, "baz", 5.0)
)

val df = spark.createDataFrame(data).toDF("col1", "col2", "col3")

// Convert all columns to string and concatenate them
val concatDF = df.withColumn(
  "concatenated",
  concat(df.columns.map(col): _*)
)

// Collect all concatenated strings and make them into one big string
val allValuesConcatenated = concatDF.select("concatenated")
  .rdd.map(r => r(0).toString)
  .reduce(_ + _)

// Hash the big string
import java.security.MessageDigest
val md = MessageDigest.getInstance("MD5")
val hash = md.digest(allValuesConcatenated.getBytes).map("%02x".format(_)).mkString

println(s"MD5 hash of the entire DataFrame: $hash")
